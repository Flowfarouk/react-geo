<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: Panel/Panel/Panel.jsx</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: Panel/Panel/Panel.jsx</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import React from 'react';
import ReactDOM from 'react-dom';
import PropTypes from 'prop-types';
import Rnd from 'react-rnd';
import { uniqueId, isNumber } from 'lodash';
import { I18nextProvider } from 'react-i18next';

import Titlebar from '../Titlebar/Titlebar.jsx';
import SimpleButton from '../../Button/SimpleButton/SimpleButton.jsx';

import './Panel.less';

const defaultWindowProps = {
  draggable: true,
  closable: true,
  collapsible: true,
  resizeOpts: true,
  width: 400,
  height: 400
};

/**
 * The Panel.
 * The panel component can also be used as a window.
 *
 * You can create a window like this:
 *
 * let winPromise = Panel.showWindow({
 *   title: 'Window Title',
 *   children: ['Peter']
 * });
 * winPromise.then(function(win) {
 *   console.log('The window was rendered: ', win);
 * });
 *
 * @class The Panel
 * @extends React.Component
 */
export class Panel extends React.Component {

  /**
   * The className added to this component.
   * @type {String}
   * @private
   */
  className = 'react-geo-panel'

  /**
   * The properties.
   * @type {Object}
   */
  static propTypes = {

    id: PropTypes.string,

    /**
     * Optional additional className that will be added to rnd.
     * @type {String}
     */
    className: PropTypes.string,

    /**
     * The dispatch function.
      @type {Function}
     */
    dispatch: PropTypes.func,

    /**
     * The children to show in the Window.
     * @type {node}
     */
    children: PropTypes.node,

    /**
     * The title text to be shown in the window Header.
     * @type {string}
     */
    title: PropTypes.string,

    /**
     * The enableResizing property is used to set the resizable permission of a
     * resizable component.
     * The permission of top, right, bottom, left, topRight, bottomRight,
     * bottomLeft, topLeft direction resizing. If omitted, all resizer are
     * enabled. If you want to permit only right direction resizing, set {
     *   top:false,
     *   right:true,
     *   bottom:false,
     *   left:false,
     *   topRight:false,
     *   bottomRight:false,
     *   bottomLeft:false,
     *   topLeft:false
     * }.
     * @type {object}
     */
    resizeOpts: PropTypes.oneOfType([
      PropTypes.object,
      PropTypes.bool
    ]),

    /**
     * Whether to allow dragging or not.
     * @type {boolean}
     */
    draggable: PropTypes.bool,

    /**
     * Whether to allow collasping or not.
     * @type {boolean}
     */
    collapsible: PropTypes.bool,

    /**
     * Whether to allow closing or not.
     * @type {boolean}
     */
    closable: PropTypes.bool,

    /**
     * The height of the panel.
     * @type {number}
     */
    height: PropTypes.number,

    /**
     * The width of the panel.
     * @type {number}
     */
    width: PropTypes.number,

    /**
     * The height of the TitleBar.
     * @type {number}
     */
    titleBarHeight: PropTypes.number,

    /**
     * The tooltip of the compress button.
     * @type {String}
     */
    compressTooltip: PropTypes.string,

    /**
     * The tooltip of the close button.
     * @type {String}
     */
    closeTooltip: PropTypes.string
  }

  /**
   * The default properties.
   * @type {Object}
   */
  static defaultProps = {
    draggable: false,
    collapsible: false,
    closable: false,
    resizeOpts: false,
    titleBarHeight: 32,
    height: 100,
    width: 100,
    compressTooltip: 'collapse',
    closeTooltip: 'close'
  }

  /**
   * Create the SimpleButton.
   *
   * @constructs SimpleButton
   */
  constructor(props) {
    super(props);
    const id = props.id || uniqueId('panel-');
    this.state = {
      id: id,
      collapsed: false,
      titleBarHeight: this.props.title ? props.titleBarHeight : 0,
      height: props.height,
      width: props.width,
      resizing: false
    };
  }

  /**
   * Toggles the collapse state of the panel.
   */
  toggleCollapse = () => {
    this.setState({
      collapsed: !this.state.collapsed
    }, () => {
      this.panel.updateSize({
        height: this.state.collapsed
          ? this.state.titleBarHeight
          : this.state.height,
        width: this.state.width
      });
    });
  }

  /**
   * Function called while resizing.
   *
   * @param {MouseEvent|TouchEvent} evt The MouseEvent event.
   * @param {String} direction A string discribing where the element was grabed.
   * @param {HTMLElement} el The element which gets resized.
   */
  onResize = (evt, direction, el) => {
    this.setState({
      height: el.clientHeight,
      width: el.clientWidth
    });
  }

  /**
   * Function called when resizing is started.
   */
  onResizeStart = () => {
    this.setState({
      resizing: true
    });
  }

  /**
   * Function called when resizing is stopped.
   */
  onResizeStop = () => {
    this.setState({
      resizing: false
    });
  }

  // TODO We might want to change the behaviour for panels that are no windows.
  /**
   * Close the panel and remove it from the dom.
   */
  close = () => {
    let div = document.getElementById(this.state.id);
    if (div) {
      ReactDOM.unmountComponentAtNode(div);
    } else {
      div = document.getElementsByClassName(this.state.id)[0];
    }

    div.parentElement.removeChild(div);
  }

  /**
   * The render function.
   */
  render() {
    const {
      closable,
      collapsible,
      draggable,
      resizeOpts,
      className,
      ...rndOpts
    } = this.props;

    const finalClassName = className
      ? `${className} ${this.className}`
      : this.className;

    const rndClassName = `${finalClassName} ${this.state.id}`;
    const disableDragging = !draggable;
    const enableResizing = resizeOpts === true ? undefined : resizeOpts;

    let tools = [];
    if (collapsible) {
      tools.push(&lt;SimpleButton
        icon="compress"
        key="compress-tool"
        onClick={this.toggleCollapse}
        tooltip={this.props.compressTooltip}
        size="small"
      />);
    }
    if (closable) {
      tools.push(&lt;SimpleButton
        icon="times"
        key="close-tool"
        onClick={this.close}
        tooltip={this.props.closeTooltip}
        size="small"
      />);
    }

    const titleBar = this.props.title ? &lt;Titlebar
      className="drag-handle"
      closable={closable}
      collapsible={collapsible}
      parent={this}
      compressTooltip={this.props.compressTooltip}
      closeTooltip={this.props.closeTooltip}
      tools={tools}
      style={{
        height: this.state.titleBarHeight,
        cursor: draggable ? 'move' : 'default'
      }}
    >
      {this.props.title}
    &lt;/Titlebar> : null;

    return (
      &lt;Rnd
        className={rndClassName}
        ref={(panel) => { this.panel = panel; }}
        default={{
          x: isNumber(rndOpts.x) ? rndOpts.x : (window.innerWidth / 2) - 160,
          y: isNumber(rndOpts.y) ? rndOpts.y : (window.innerHeight / 2) - 100,
          width: rndOpts.width || 160,
          height: this.state.collapsed
            ? this.state.titleBarHeight
            : this.state.height
        }}
        dragHandleClassName=".drag-handle"
        disableDragging={disableDragging}
        enableResizing={enableResizing}
        resizeHandleClasses={{
          bottom: 'resize-handle resize-handle-bottom',
          bottomLeft: 'resize-handle resize-handle-bottom-left',
          bottomRight: 'resize-handle resize-handle-bottom-right',
          left: 'resize-handle resize-handle-left',
          right: 'resize-handle resize-handle-right',
          top: 'resize-handle resize-handle-top',
          topLeft: 'resize-handle resize-handle-top-left',
          topRight: 'resize-handle resize-handle-top-right'
        }}
        onResize={this.onResize}
        onResizeStart={this.onResizeStart}
        onResizeStop={this.onResizeStop}
        {...rndOpts}
      >
        {titleBar}
        &lt;div
          className="body"
          style={{
            cursor: 'default',
            overflow: 'hidden',
            height: this.state.collapsed
              ? '0px'
              : this.state.height - this.state.titleBarHeight,
            transition: this.state.resizing ? '' : 'height 0.25s',
          }}
        >
          {this.props.children}
        &lt;/div>
      &lt;/Rnd>
    );
  }
}

/**
 * This static method creates a window and adds it to the container with the id
 * props.containerId.
 * e.g.:
 * let winPromise = Panel.showWindow({
 *   title: 'Window Title',
 *   children: ['Peter']
 * });
 * winPromise.then(function(win) {
 *   console.log('The window was rendered: ', win);
 * });
 *
 * @param {Object} props The props added to the window on creation.
 *                       Use 'children' to add child elements to the body of the
 *                       window.
 * @return {Promise} A promise that contains the win when resolved.
 *                   "reject" is not expect and so not handled.
 */
Panel.showWindow = function(props) {
  props = {
    ...defaultWindowProps,
    ...props
  };
  let {i18n} = props;
  let windowClassName = 'react-geo-window';

  props.className = props.className
    ? `${props.className} ${windowClassName}`
    : windowClassName;

  let container = document.getElementById(props.containerId);
  let div = document.createElement('div');
  let id = uniqueId(`${windowClassName}-`);

  div.style.position = 'absolute';
  div.style.left = 0;
  div.style.top = 0;
  div.id = id;
  container.appendChild(div);

  props.bounds = '#' + props.containerId;
  props.id = id;

  return new Promise(function(resolve) {
    ReactDOM.render(
      i18n
        ? &lt;I18nextProvider i18n={i18n}>
          &lt;Panel {...props} />
        &lt;/I18nextProvider>
        : &lt;Panel {...props} />,
      div,
      function() {
        resolve(this);
      }
    );
  });
};

export default Panel;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="CsrfUtil.html">CsrfUtil</a></li><li><a href="FeatureUtil.html">FeatureUtil</a></li><li><a href="FloatingMapLogo.html">FloatingMapLogo</a></li><li><a href="LayerTransparencySlider.html">LayerTransparencySlider</a></li><li><a href="LayerTree.html">LayerTree</a></li><li><a href="LayerTreeNode.html">LayerTreeNode</a></li><li><a href="Legend.html">Legend</a></li><li><a href="MapComponent.html">MapComponent</a></li><li><a href="MappifiedComponent.html">MappifiedComponent</a></li><li><a href="MapProvider.html">MapProvider</a></li><li><a href="MapUtil.html">MapUtil</a></li><li><a href="NominatimSearch.html">NominatimSearch</a></li><li><a href="ObjectUtil.html">ObjectUtil</a></li><li><a href="Panel.html">Panel</a></li><li><a href="ScaleCombo.html">ScaleCombo</a></li><li><a href="SimpleButton.html">SimpleButton</a></li><li><a href="StringUtil.html">StringUtil</a></li><li><a href="TestUtil.html">TestUtil</a></li><li><a href="Titlebar.html">Titlebar</a></li><li><a href="ToggleButton.html">ToggleButton</a></li><li><a href="ToggleGroup.html">ToggleGroup</a></li><li><a href="Toolbar.html">Toolbar</a></li><li><a href="UndoUtil.html">UndoUtil</a></li><li><a href="UrlUtil.html">UrlUtil</a></li><li><a href="UserChip.html">UserChip</a></li><li><a href="VisibleComponent.html">VisibleComponent</a></li></ul><h3>Global</h3><ul><li><a href="global.html#absolutelyPostioned">absolutelyPostioned</a></li><li><a href="global.html#addressdetails">addressdetails</a></li><li><a href="global.html#alignment">alignment</a></li><li><a href="global.html#allowDeselect">allowDeselect</a></li><li><a href="global.html#bounded">bounded</a></li><li><a href="global.html#children">children</a></li><li><a href="global.html#className">className</a></li><li><a href="global.html#closable">closable</a></li><li><a href="global.html#closeTooltip">closeTooltip</a></li><li><a href="global.html#collapsible">collapsible</a></li><li><a href="global.html#componentDidMount">componentDidMount</a></li><li><a href="global.html#compressTooltip">compressTooltip</a></li><li><a href="global.html#countrycodes">countrycodes</a></li><li><a href="global.html#dispatch">dispatch</a></li><li><a href="global.html#draggable">draggable</a></li><li><a href="global.html#extraParams">extraParams</a></li><li><a href="global.html#filterFunction">filterFunction</a></li><li><a href="global.html#format">format</a></li><li><a href="global.html#getInitials">getInitials</a></li><li><a href="global.html#getOptionsFromMap:Helperfunctiongenerate%257B@linkOption%257Dscalecomponentsbasedonanexistinginstanceof%257B@linkOl.Map%257D">getOptionsFromMap: Helper function generate {@link Option} scale components
based on an existing instance of {@link Ol.Map}</a></li><li><a href="global.html#height">height</a></li><li><a href="global.html#imageHeight">imageHeight</a></li><li><a href="global.html#imageSrc">imageSrc</a></li><li><a href="global.html#isVisibleComponent">isVisibleComponent</a></li><li><a href="global.html#layer">layer</a></li><li><a href="global.html#limit">limit</a></li><li><a href="global.html#map">map</a></li><li><a href="global.html#mappify">mappify</a></li><li><a href="global.html#mapPromise">mapPromise</a></li><li><a href="global.html#minChars">minChars</a></li><li><a href="global.html#name">name</a></li><li><a href="global.html#nodeTitleRenderer">nodeTitleRenderer</a></li><li><a href="global.html#nominatimBaseUrl">nominatimBaseUrl</a></li><li><a href="global.html#onChange">onChange</a></li><li><a href="global.html#onSelect">onSelect</a></li><li><a href="global.html#onZoomLevelSelect">onZoomLevelSelect</a></li><li><a href="global.html#orientation">orientation</a></li><li><a href="global.html#parent">parent</a></li><li><a href="global.html#polygon_geojson">polygon_geojson</a></li><li><a href="global.html#pushScaleOption:Helperfunctiontocreatea%257B@linkOption%257Dscalecomponentbasedonaresolutionandthe%257B@linkOl.View%257D">pushScaleOption: Helper function to create a {@link Option} scale component
based on a resolution and the {@link Ol.View}</a></li><li><a href="global.html#renderOption">renderOption</a></li><li><a href="global.html#resizeOpts">resizeOpts</a></li><li><a href="global.html#resolutions">resolutions</a></li><li><a href="global.html#scales">scales</a></li><li><a href="global.html#selectedName">selectedName</a></li><li><a href="global.html#style">style</a></li><li><a href="global.html#syncWithMap">syncWithMap</a></li><li><a href="global.html#title">title</a></li><li><a href="global.html#titleBarHeight">titleBarHeight</a></li><li><a href="global.html#tools">tools</a></li><li><a href="global.html#userMenu">userMenu</a></li><li><a href="global.html#userName">userName</a></li><li><a href="global.html#viewbox">viewbox</a></li><li><a href="global.html#width">width</a></li><li><a href="global.html#zoomLevel">zoomLevel</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Tue Nov 14 2017 16:21:35 GMT+0000 (UTC)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
