<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>CoordinateReferenceSystemCombo example</title>
  <link rel="stylesheet" href="//openlayers.org/en/latest/css/ol.css" type="text/css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>/*global hljs*/ hljs.initHighlightingOnLoad();</script>
</head>
<style>
body.example {
  padding: 1.5em;
}
.example-block {
  padding: 2em;
}
.example-block > span {
  margin-right: 10px;
}
</style>

<body class="example">
  <h2>CoordinateReferenceSystemCombo example</h2>
  <div id="exampleContainer" class="app"></div>
  <p>This demonstrates the usage of the CoordinateReferenceSystemCombo.</p>

  <pre>
    <code class="javascript">import React from &#x27;react&#x27;;
import { render } from &#x27;react-dom&#x27;;
import { CoordinateReferenceSystemCombo } from &#x27;@terrestris/react-geo&#x27;;

import proj4 from &#x27;proj4&#x27;;
import OlMap from &#x27;ol/map&#x27;;
import OlView from &#x27;ol/view&#x27;;
import OlLayerTile from &#x27;ol/layer/tile&#x27;;
import OlSourceOsm from &#x27;ol/source/osm&#x27;;
import OlProjection from &#x27;ol/proj&#x27;;
import OlExtent from &#x27;ol/extent&#x27;;

//
// ***************************** SETUP *****************************************
//
const defaultView &#x3D; new OlView({
  center: OlProjection.fromLonLat([37.40570, 8.81566]),
  zoom: 4
});
const map &#x3D; new OlMap({
  layers: [
    new OlLayerTile({
      name: &#x27;OSM&#x27;,
      source: new OlSourceOsm()
    })
  ],
  view: defaultView
});

OlProjection.setProj4(proj4);

/**
 * set map projection and perform client-side raster reprojection from
 * OSM (EPSG:3857) to arbitrary projection given in crsObj
 *
 * original code of setProjection can be found here:
 * https://openlayers.org/en/latest/examples/reprojection-by-code.html
 */
const setProjection &#x3D; (crsObj) &#x3D;&gt; {
  const {
    code, value, proj4def, bbox
  } &#x3D; crsObj;

  if (code &#x3D;&#x3D;&#x3D; null || value &#x3D;&#x3D;&#x3D; null || proj4def &#x3D;&#x3D;&#x3D; null || bbox &#x3D;&#x3D;&#x3D; null) {
    map.setView(defaultView);
    return;
  }

  var newProjCode &#x3D; &#x27;EPSG:&#x27; + code;
  proj4.defs(newProjCode, proj4def);
  var newProj &#x3D; OlProjection.get(newProjCode);
  var fromLonLat &#x3D; OlProjection.getTransform(&#x27;EPSG:4326&#x27;, newProj);

  // very approximate calculation of projection extent
  var extent &#x3D; OlExtent.applyTransform(
    [bbox[1], bbox[2], bbox[3], bbox[0]], fromLonLat);
  newProj.setExtent(extent);
  var newView &#x3D; new OlView({
    projection: newProj
  });
  map.setView(newView);
  newView.fit(extent);
};


const predefinedCrsDefinitions &#x3D; [{
  code: &#x27;25832&#x27;,
  value: &#x27;ETRS89 / UTM zone 32N&#x27;
}, {
  code: &#x27;31466&#x27;,
  value: &#x27;DHDN / 3-degree Gauss-Kruger zone 2&#x27;
}, {
  code: &#x27;31467&#x27;,
  value: &#x27;DHDN / 3-degree Gauss-Kruger zone 3&#x27;
}, {
  code: &#x27;4326&#x27;,
  value: &#x27;WGS 84&#x27;
}];

//
// ***************************** SETUP END *************************************
//

render(
  &lt;div&gt;
    &lt;div id&#x3D;&quot;map&quot;&gt;&lt;/div&gt;

    &lt;div className&#x3D;&quot;example-block&quot;&gt;
      &lt;span&gt;A &lt;code&gt;CoordinateReferenceSystemCombo&lt;/code&gt; with autocomplete mode where CRS are fetched from &lt;a href&#x3D;&quot;http://epsg.io/&quot;&gt;epsg.io/&lt;/a&gt;.
        If a CRS is selected (prop &lt;code&gt;onSelect&lt;/code&gt;), the projection is used to perform client-side raster reprojection of OSM layer in map.
      &lt;/span&gt;
      &lt;br /&gt;

      &lt;CoordinateReferenceSystemCombo
        emptyTextPlaceholderText&#x3D;&quot;Type to fetch definitions dynamically&quot;
        onSelect&#x3D;{setProjection} /&gt;
    &lt;/div&gt;

    &lt;div className&#x3D;&quot;example-block&quot;&gt;
      &lt;span&gt;A &lt;code&gt;CoordinateReferenceSystemCombo&lt;/code&gt; with predefined definitions of four CRS. Selecting an option does not affect the map.&lt;/span&gt;
      &lt;br /&gt;

      {/* A CoordinateReferenceSystemCombo having predefinedCrsDefinitions*/}
      &lt;CoordinateReferenceSystemCombo
        predefinedCrsDefinitions&#x3D;{predefinedCrsDefinitions} /&gt;
    &lt;/div&gt;

  &lt;/div&gt;,

  // Target element
  document.getElementById(&#x27;exampleContainer&#x27;),

  // Callback
  () &#x3D;&gt; {
    map.setTarget(&#x27;map&#x27;);
  }
);
</code>
  </pre>
  <script src="../../commons.js"></script>
  <script src="CoordinateReferenceSystemCombo.js"></script>
</body>
</html>
