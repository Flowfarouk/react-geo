<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>AddWmsPanel example</title>
  <link rel="stylesheet" href="//openlayers.org/en/latest/css/ol.css" type="text/css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>/*global hljs*/ hljs.initHighlightingOnLoad();</script>
</head>
<style>
body.example {
  padding: 1.5em;
}
.example-block {
  padding: 2em;
}
.example-block > span {
  margin-right: 10px;
}
</style>

<body class="example">
  <h2>AddWmsPanel example</h2>
  <div id="exampleContainer" class="app"></div>
  <p>In this example layers of a WMS can be added to a map.
The capabilities of this WMS are fetched and parsed to OL layer instances using the <code>CapabilitiesUtil</code>.
An <code>AddWmsPanel</code> shows a list of the parsed layers and each checked layer (or the entire set) can be added to the map.</p>

  <pre>
    <code class="javascript">import React from &#x27;react&#x27;;
import { render } from &#x27;react-dom&#x27;;
import { message } from &#x27;antd&#x27;;
import { AddWmsPanel, SimpleButton, CapabilitiesUtil } from &#x27;@terrestris/react-geo&#x27;;

import OlMap from &#x27;ol/map&#x27;;
import OlView from &#x27;ol/view&#x27;;
import OlLayerTile from &#x27;ol/layer/tile&#x27;;
import OlSourceOsm from &#x27;ol/source/osm&#x27;;
import OlProjection from &#x27;ol/proj&#x27;;

//
// ***************************** SETUP *****************************************
//
const defaultView &#x3D; new OlView({
  center: OlProjection.fromLonLat([7.40570, 53.81566]),
  zoom: 4
});
const map &#x3D; new OlMap({
  layers: [
    new OlLayerTile({
      name: &#x27;OSM&#x27;,
      source: new OlSourceOsm()
    })
  ],
  view: defaultView
});

//
// ***************************** SETUP END *************************************
//

// Please note: CORS headers must be set on server providing capabilities document. Otherwise proxy needed.
const WMS_CAPABILITIES_URL &#x3D; &#x27;https://ows.terrestris.de/osm/service?SERVICE&#x3D;WMS&amp;VERSION&#x3D;1.3.0&amp;REQUEST&#x3D;GetCapabilities&#x27;;

/**
 * fetch capabilities document onClick and re-render on success
 */
const onClick &#x3D; () &#x3D;&gt; {
  CapabilitiesUtil.parseWmsCapabilities(WMS_CAPABILITIES_URL)
    .then(CapabilitiesUtil.getLayersFromWmsCapabilties)
    .then((layers) &#x3D;&gt; {
      doRender(layers);
    })
    .catch(() &#x3D;&gt; message.error(&#x27;Could not parse capabilities document.&#x27;));
};

/**
 * wrapper function for render
 */
const doRender &#x3D; (wmsLayers) &#x3D;&gt; {
  render(
    &lt;div&gt;
      &lt;div id&#x3D;&quot;map&quot; /&gt;
      &lt;div className&#x3D;&quot;example-block&quot;&gt;
        &lt;SimpleButton
          onClick&#x3D;{onClick}
        &gt;
          Fetch capabilities of OWS terrestris
        &lt;/SimpleButton&gt;
        &lt;AddWmsPanel
          key&#x3D;&quot;1&quot;
          map&#x3D;{map}
          wmsLayers&#x3D;{wmsLayers}
          draggable&#x3D;{true}
          t&#x3D;{t &#x3D;&gt; t}
          width&#x3D;{500}
          height&#x3D;{400}
          x&#x3D;{0}
          y&#x3D;{100}
        /&gt;
      &lt;/div&gt;
    &lt;/div&gt;,

    // Target element
    document.getElementById(&#x27;exampleContainer&#x27;),

    // Callback
    () &#x3D;&gt; {
      map.setTarget(&#x27;map&#x27;);
    }
  );
};

doRender([]);
</code>
  </pre>
  <script src="../../vendors.js"></script>
  <script src="../../commons.js"></script>
  <script src="AddWmsPanel.js"></script>
</body>
</html>
